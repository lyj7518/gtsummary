---
title: "gtsummary 패키지 소개"
author: "Yujin Lee"
date: 'r format(Sys.Date())'
output:
  html_document:
    fig_height: 6
    fig_width: 10
    highlight: textmate
    theme: cosmo
    toc: yes
    toc_depth: 2
    toc_float: yes
    df_print: paged
  word_document:
    toc: yes
    toc_depth: '2'
  pdf_document:
    toc: yes
    toc_depth: '2'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=F, fig.align = "center", message=F, warning=F)
```

# Setup

```{r, echo=T}
# install.packages("gtsummary")
library(data.table)
library(gtsummary)
```

# Road data

예제에 사용할 데이터를 `fread`함수를 통해 불러오자. 데이터는 09-15년 공단 건강검진 데이터에서 실습용으로 32 명을 뽑은 자료이며, 자세한 내용은  ["data/2교시 테이블 세부 레이아웃 소개(최신자료).pdf"](https://github.com/jinseob2kim/lecture-snuhlab/raw/master/data/2%EA%B5%90%EC%8B%9C%20%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%84%B8%EB%B6%80%20%EB%A0%88%EC%9D%B4%EC%95%84%EC%9B%83%20%EC%86%8C%EA%B0%9C(%EC%B5%9C%EC%8B%A0%EC%9E%90%EB%A3%8C).pdf) 를 참고하자.

```{r, echo=T}
# Load file

url <- "https://raw.githubusercontent.com/jinseob2kim/lecture-snuhlab/master/data/example_g1e.csv"
dt <- fread(url,header=T)
```

# Basic Usage

`tbl_summary` 함수를 사용하여 기본 테이블을 작성할 수 있다. 출력값으로 데이터 셋의 각 열에 대한 통계량을 반환한다. 기본 기능으로 데이터 셋에 섞인 범주형 변수와 연속형 변수를 자동적으로 인식해 그에 맞는 값을 반환하며, 범주형 변수의 default 통계량은 n(%)이고 연속형 변수의 default 통계량은 median(IQR)이다. 결측값은 테이블에 Unknown으로 출력된다.

```{r, echo=T}
dt %>% tbl_summary()
```

## 그룹 연산 by

`tbl_summary` 함수에는 다양한 옵션이 존재한다. **by** 옵션을 이용하여 그룹 연산을 수행할 수 있다. by 옵션에 그룹 연산을 수행할 변수를 지정하여 사용 가능하다. 다음 예시에서 연도변수인 EXMD_BZ_YYYY를 기준으로 그룹 연산을 수행해보자.

```{r, echo=T}
dt %>% tbl_summary(by="EXMD_BZ_YYYY")
```

# Modifying function arguments `tbl_summary`

`tbl_summary` 함수에는 다양한 옵션이 존재하며, 이러한 옵션 조정을 통해 원하는 테이블을 작성할 수 있다. 다음은 `tbl_summary` 함수의 주요 옵션에 대한 설명이다.

- label :
- type : 
- statistic :
- digits :
- missing :
- missing_text :
- sort :
- percent :
- include :

옵션을 활용한 예시이다. 연도변수 EXMD_BZ_YYYY를 그룹 짓고, Q_SMK_YN 변수를 "smoking y/n"로 바꾸어보자. 이때, 연속형 변수의 기본 출력값은 {median} ({sd})였지만, 이를 {mean}({sd})으로 바꾸어보자.

```{r, echo=T}
dt %>%
  tbl_summary(
    by = EXMD_BZ_YYYY,
    statistic = list(all_continuous() ~ "{mean} ({sd})",
                     all_categorical() ~ "{n} / {N} ({p}%)"),
    digits = all_continuous() ~ 2,
    label = Q_SMK_YN ~ "smoking y/n",
    missing_text = "Missing"
  )
```



```{r, ehco=T}

```








































